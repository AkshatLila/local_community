{% extends "base.html" %}

{% block title %}Dashboard - Community Portal{% endblock %}
{% block header_title %}Dashboard{% endblock %}

{% block content %}
<!-- Page Header -->
<div class="card">
    <div class="card-body">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <div>
                <h2 style="margin: 0; color: var(--dark-slate);">Secretary Dashboard</h2>
                <p style="margin: 0.5rem 0 0 0; color: var(--light-gray);">Society Secretary Panel</p>
            </div>
        </div>
    </div>
</div>

<!-- Statistics Cards -->
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
    <div class="card">
        <div class="card-body">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <h3 style="margin: 0; color: var(--primary-blue); font-size: 2rem;">{{ total_users }}</h3>
                    <p style="margin: 0.5rem 0 0 0; color: var(--light-gray);">Total Residents</p>
                </div>
                <div style="color: var(--primary-blue);">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                        <circle cx="9" cy="7" r="4"></circle>
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                    </svg>
                </div>
            </div>
        </div>
    </div>
    
    <div class="card">
        <div class="card-body">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <h3 style="margin: 0; color: var(--success-green); font-size: 2rem;">{{ total_notices }}</h3>
                    <p style="margin: 0.5rem 0 0 0; color: var(--light-gray);">Total Notices</p>
                </div>
                <div style="color: var(--success-green);">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                        <line x1="12" y1="9" x2="12" y2="13"></line>
                        <line x1="12" y1="17" x2="12.01" y2="17"></line>
                    </svg>
                </div>
            </div>
        </div>
    </div>
    
    <div class="card">
        <div class="card-body">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <h3 style="margin: 0; color: var(--warning-orange); font-size: 2rem;">{{ pending_requests }}</h3>
                    <p style="margin: 0.5rem 0 0 0; color: var(--light-gray);">Pending Requests</p>
                </div>
                <div style="color: var(--warning-orange);">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path>
                    </svg>
                </div>
            </div>
        </div>
    </div>
    
    <div class="card">
        <div class="card-body">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <h3 style="margin: 0; color: var(--info-blue); font-size: 2rem;">{{ total_messages }}</h3>
                    <p style="margin: 0.5rem 0 0 0; color: var(--light-gray);">Chat Messages</p>
                </div>
                <div style="color: var(--info-blue);">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Quick Actions -->
<div class="card">
    <div class="card-header">
        <h3 class="card-title">Quick Actions</h3>
    </div>
    <div class="card-body">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
            <a href="{{ url_for('secretary_post_notice') }}" class="btn btn-outline" style="display: flex; flex-direction: column; align-items: center; padding: 1.5rem; text-decoration: none;">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-bottom: 0.5rem;">
                    <path d="M12 5v14M5 12h14"></path>
                </svg>
                <span>Post Notice</span>
            </a>
            <a href="{{ url_for('secretary_requests') }}" class="btn btn-outline" style="display: flex; flex-direction: column; align-items: center; padding: 1.5rem; text-decoration: none;">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-bottom: 0.5rem;">
                    <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path>
                </svg>
                <span>Manage Requests</span>
            </a>
            <a href="{{ url_for('secretary_users') }}" class="btn btn-outline" style="display: flex; flex-direction: column; align-items: center; padding: 1.5rem; text-decoration: none;">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-bottom: 0.5rem;">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                    <circle cx="9" cy="7" r="4"></circle>
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                </svg>
                <span>Manage Residents</span>
            </a>
            <a href="{{ url_for('chat') }}" class="btn btn-outline" style="display: flex; flex-direction: column; align-items: center; padding: 1.5rem; text-decoration: none;">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-bottom: 0.5rem;">
                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                </svg>
                <span>Monitor Chat</span>
            </a>
        </div>
    </div>
</div>

<!-- Recent Activity -->
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-top: 2rem;">
    <!-- Recent Service Requests -->
    <div class="card">
        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
            <h3 class="card-title">Recent Service Requests</h3>
            <a href="{{ url_for('secretary_requests') }}" class="btn btn-sm btn-outline">View All</a>
        </div>
        <div class="card-body">
            {% if recent_requests %}
                {% for request in recent_requests %}
                    <div style="padding: 1rem; border: 1px solid var(--border-gray); border-radius: var(--border-radius); margin-bottom: 1rem; background-color: #fafbfc;">
                        <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                            <div style="flex: 1;">
                                <h4 style="margin: 0 0 0.5rem 0; font-size: 1rem; color: var(--dark-slate);">{{ request.title }}</h4>
                                <p style="margin: 0 0 0.5rem 0; color: var(--light-gray); font-size: 0.875rem;">
                                    {{ request.description[:100] }}{% if request.description|length > 100 %}...{% endif %}
                                </p>
                                <div style="display: flex; gap: 1rem; color: var(--light-gray); font-size: 0.875rem;">
                                    <span>{{ request.user_name }}</span>
                                    <span>{{ request.apartment }}</span>
                                    <span>{{ format_datetime(request.created_at) }}</span>
                                </div>
                            </div>
                            <span class="status-indicator status-{{ 'pending' if request.status == 'pending' else 'in-progress' if request.status == 'in_progress' else 'resolved' }}">
                                {{ request.status|replace('_', ' ')|title }}
                            </span>
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <p style="text-align: center; color: var(--light-gray); padding: 2rem;">No recent service requests</p>
            {% endif %}
        </div>
    </div>
    
    <!-- Recent Notices -->
    <div class="card">
        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
            <h3 class="card-title">Recent Notices (Latest 3)</h3>
            <a href="{{ url_for('secretary_notices') }}" class="btn btn-sm btn-outline">View All</a>
        </div>
        <div class="card-body">
            {% if recent_notices %}
                {% for notice in recent_notices %}
                    <div style="padding: 1rem; border: 1px solid var(--border-gray); border-radius: var(--border-radius); margin-bottom: 1rem; background-color: #fafbfc;">
                        <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                            <div style="flex: 1;">
                                <h4 style="margin: 0 0 0.5rem 0; font-size: 1rem; color: var(--dark-slate);">{{ notice.title }}</h4>
                                <p style="margin: 0 0 0.5rem 0; color: var(--light-gray); font-size: 0.875rem;">
                                    {{ notice.content[:100] }}{% if notice.content|length > 100 %}...{% endif %}
                                </p>
                                <small style="color: var(--light-gray);">
                                    {{ format_datetime(notice.created_at) }}
                                </small>
                            </div>
                            <span class="badge badge-{{ 'danger' if notice.priority == 'urgent' else 'warning' if notice.priority == 'high' else 'info' if notice.priority == 'medium' else 'success' }}">
                                {{ notice.priority|title }}
                            </span>
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <p style="text-align: center; color: var(--light-gray); padding: 2rem;">No recent notices</p>
            {% endif %}
        </div>
    </div>
</div>

 
{% endblock %}

{% block scripts %}
<style>
@keyframes pulse {
    0% {
        opacity: 1;
    }
    50% {
        opacity: 0.5;
    }
    100% {
        opacity: 1;
    }
}
</style>
{% endblock %}
